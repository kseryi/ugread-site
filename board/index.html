<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞ –æ—Ñ–ª–∞–π–Ω-–¥–æ—à–∫–∞</title>
  <link rel="stylesheet" href="style.css"/>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.14.305/pdf.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
<script type="module" src="ukr.js"></script>

</head>
<body>
  <!-- –í–µ—Ä—Ö–Ω—è –ø–∞–Ω–µ–ª—å: –≤–∏–±—ñ—Ä –ø—Ä–µ–¥–º–µ—Ç—É + –∫–Ω–æ–ø–∫–∏ –ø–æ–∫–∞–∑—É –ø–∞–Ω–µ–ª–µ–π -->
  <header class="topbar">

    <div class="topbar-left">
        
      <button id="toggleLeft" class="ghost-btn" title="–ü–æ–∫–∞–∑–∞—Ç–∏/—Å—Ö–æ–≤–∞—Ç–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏" aria-label="–ü–æ–∫–∞–∑–∞—Ç–∏/—Å—Ö–æ–≤–∞—Ç–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏">‚ò∞</button>
    <img src="logo.png" alt="–õ–æ–≥–æ—Ç–∏–ø –∫–æ–º–ø–∞–Ω—ñ—ó" class="logo"/>
    </div>
    <div class="topbar-right">
      <label class="sr-only" for="subjectSelect">–ü—Ä–µ–¥–º–µ—Ç</label>
      <select id="subjectSelect" title="–û–±–µ—Ä—ñ—Ç—å –ø—Ä–µ–¥–º–µ—Ç">
        <option value="" selected>‚Äî –±–µ–∑ –ø—Ä–µ–¥–º–µ—Ç—É ‚Äî</option>
        <option value="ukr">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ –º–æ–≤–∞</option>
        <option value="math">–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞</option>
        <option value="geography">–ì–µ–æ–≥—Ä–∞—Ñ—ñ—è</option>
        <option value="chemistry">–•—ñ–º—ñ—è</option>
        <option value="biology">–ë—ñ–æ–ª–æ–≥—ñ—è</option>
        <option value="history">–Ü—Å—Ç–æ—Ä—ñ—è</option>
        <option value="physics">–§—ñ–∑–∏–∫–∞</option>
      </select>
      <button id="toggleRight" class="ghost-btn" title="–ü–æ–∫–∞–∑–∞—Ç–∏/—Å—Ö–æ–≤–∞—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤—É –ø–∞–Ω–µ–ª—å" aria-label="–ü–æ–∫–∞–∑–∞—Ç–∏/—Å—Ö–æ–≤–∞—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤—É –ø–∞–Ω–µ–ª—å">‚äü</button>
    </div>
  </header>

  <!-- –õ—ñ–≤–∞ –ø–∞–Ω–µ–ª—å —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ -->
  <aside id="leftPanel" class="side-panel left">
    <div class="tool-group">
      <!-- –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –≤–∏–±–æ—Ä—É/–ø–µ—Ä–µ–º—ñ—â–µ–Ω–Ω—è -->
      <button class="tool-btn" data-tool="select" title="–í–∏–±—ñ—Ä/–ø–µ—Ä–µ–º—ñ—â–µ–Ω–Ω—è" aria-label="–í–∏–±—ñ—Ä/–ø–µ—Ä–µ–º—ñ—â–µ–Ω–Ω—è">
        <!-- –∫—É—Ä—Å–æ—Ä -->
        <svg viewBox="0 0 24 24"><path d="M3 2l7 18 2-7 7-2L3 2z"/></svg>
      </button>
      <!-- –û–ª—ñ–≤–µ—Ü—å (–≤—ñ–ª—å–Ω–µ –º–∞–ª—é–≤–∞–Ω–Ω—è) -->
      <button class="tool-btn" data-tool="pencil" title="–û–ª—ñ–≤–µ—Ü—å" aria-label="–û–ª—ñ–≤–µ—Ü—å">
        <svg viewBox="0 0 24 24"><path d="M3 21l3-1 12-12-2-2L4 18l-1 3zM15 3l2 2"/></svg>
      </button>
      <!-- –ü—Ä—è–º–∞ –ª—ñ–Ω—ñ—è -->
      <button class="tool-btn" data-tool="line" title="–õ—ñ–Ω—ñ—è" aria-label="–õ—ñ–Ω—ñ—è">
        <svg viewBox="0 0 24 24"><path d="M4 20L20 4"/></svg>
      </button>
      <!-- –ü—Ä—è–º–æ–∫—É—Ç–Ω–∏–∫ -->
      <button class="tool-btn" data-tool="rect" title="–ü—Ä—è–º–æ–∫—É—Ç–Ω–∏–∫" aria-label="–ü—Ä—è–º–æ–∫—É—Ç–Ω–∏–∫">
        <svg viewBox="0 0 24 24"><rect x="4" y="5" width="16" height="14" rx="1"/></svg>
      </button>
      <!-- –û–≤–∞–ª -->
      <button class="tool-btn" data-tool="ellipse" title="–û–≤–∞–ª" aria-label="–û–≤–∞–ª">
        <svg viewBox="0 0 24 24"><ellipse cx="12" cy="12" rx="8" ry="6"/></svg>
      </button>
      <!-- –ö–æ–ª–æ -->
      <button class="tool-btn" data-tool="circle" title="–ö–æ–ª–æ" aria-label="–ö–æ–ª–æ">
        <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="7"/></svg>
      </button>
      <!-- –õ–∞–º–∞–Ω–∞ -->
      <button class="tool-btn" data-tool="polyline" title="–õ–∞–º–∞–Ω–∞ –ª—ñ–Ω—ñ—è" aria-label="–õ–∞–º–∞–Ω–∞ –ª—ñ–Ω—ñ—è">
        <svg viewBox="0 0 24 24"><polyline points="4,18 8,8 14,14 20,6"/></svg>
      </button>
      <!-- –¢—Ä–∏–∫—É—Ç–Ω–∏–∫ -->
      <button class="tool-btn" data-tool="triangle" title="–¢—Ä–∏–∫—É—Ç–Ω–∏–∫" aria-label="–¢—Ä–∏–∫—É—Ç–Ω–∏–∫">
        <svg viewBox="0 0 24 24"><polygon points="12,5 4,19 20,19"/></svg>
      </button>
      <!-- –ü'—è—Ç–∏–∫—É—Ç–Ω–∏–∫ -->
      <button class="tool-btn" data-tool="pentagon" title="–ü'—è—Ç–∏–∫—É—Ç–Ω–∏–∫" aria-label="–ü'—è—Ç–∏–∫—É—Ç–Ω–∏–∫">
        <svg viewBox="0 0 24 24"><polygon points="12,3 3,10 6,21 18,21 21,10"/></svg>
      </button>
      <!-- –®–µ—Å—Ç–∏–∫—É—Ç–Ω–∏–∫ -->
      <button class="tool-btn" data-tool="hexagon" title="–®–µ—Å—Ç–∏–∫—É—Ç–Ω–∏–∫" aria-label="–®–µ—Å—Ç–∏–∫—É—Ç–Ω–∏–∫">
        <svg viewBox="0 0 24 24"><polygon points="6,4 18,4 22,12 18,20 6,20 2,12"/></svg>
      </button>
      <!-- –ó—ñ—Ä–∫–∞ -->
      <button class="tool-btn" data-tool="star" title="–ó—ñ—Ä–∫–∞" aria-label="–ó—ñ—Ä–∫–∞">
        <svg viewBox="0 0 24 24"><polygon points="12,3 14.9,9.2 21.6,9.2 16.2,13.1 18.5,20 12,15.9 5.5,20 7.8,13.1 2.4,9.2 9.1,9.2"/></svg>
      </button>
    </div>

    <div class="settings">
      <div class="setting-row">
        <label class="setting-label">–ö–æ–ª—ñ—Ä –ª—ñ–Ω—ñ—ó</label>
        <input type="color" id="strokeColor" value="#111111"/>
      </div>
      <div class="setting-row">
        <label class="setting-label">–¢–æ–≤—â–∏–Ω–∞</label>
        <input type="range" id="strokeWidth" min="1" max="20" value="2"/>
        <span id="strokeWidthVal">2</span>
      </div>
      <div class="setting-row">
        <label class="setting-label">–°—Ç–∏–ª—å</label>
        <select id="strokeStyle">
          <option value="solid" selected>–°—É—Ü—ñ–ª—å–Ω–∞</option>
          <option value="dashed">–®—Ç—Ä–∏—Ö–æ–≤–∞</option>
          <option value="dotted">–ü—É–Ω–∫—Ç–∏—Ä</option>
        </select>
      </div>
      <div class="setting-row">
        <label class="setting-label">–ó–∞–ª–∏–≤–∫–∞</label>
        <input type="color" id="fillColor" value="#ffffff"/>
        <label class="checkbox-inline"><input type="checkbox" id="noFill" checked/> –±–µ–∑ –∑–∞–ª–∏–≤–∫–∏</label>
      </div>
      <div class="setting-row">
        <button id="deleteSelected" class="danger-btn" title="–í–∏–¥–∞–ª–∏—Ç–∏ –≤–∏–±—Ä–∞–Ω–µ">üóë</button>
        <button id="clearAll" class="danger-btn" title="–û—á–∏—Å—Ç–∏—Ç–∏ –¥–æ—à–∫—É">‚úñ</button>
      </div>
      <div class="setting-row">
        <button id="downloadSVG" class="ghost-btn" title="–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —è–∫ SVG">‚¨á SVG</button>
        <button id="downloadPNG" class="ghost-btn" title="–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —è–∫ PNG">‚¨á PNG</button>
      </div>
    </div>
  </aside>

  <!-- –ü—Ä–∞–≤–∞ –ø–∞–Ω–µ–ª—å (–¥–∏–Ω–∞–º—ñ—á–Ω–∞ –ø—ñ–¥ –ø—Ä–µ–¥–º–µ—Ç) -->
  <aside id="rightPanel" class="side-panel right">
    <div id="subjectPanel" class="subject-panel">
      <p class="muted">–û–±–µ—Ä—ñ—Ç—å –ø—Ä–µ–¥–º–µ—Ç —É –≤–µ—Ä—Ö–Ω—å–æ–º—É –ø—Ä–∞–≤–æ–º—É –∫—É—Ç—ñ, —â–æ–± –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏.</p>
    </div>
  </aside>

  <!-- –ë—ñ–ª–µ –ø–æ–ª–æ—Ç–Ω–æ (SVG) -->
  <main class="board-wrap">
    <div id="boardContainer">
      <svg id="board" xmlns="http://www.w3.org/2000/svg" tabindex="0">
        <rect id="boardBg" x="0" y="0" width="100%" height="100%" fill="#ffffff"></rect>
        <!-- –®–∞—Ä–∏ –¥–ª—è —Ñ–æ–Ω—É, –º–∞–ª—é–Ω–∫—ñ–≤ —Ç–∞ –≤–∏–¥—ñ–ª–µ–Ω–Ω—è -->
        <g id="bgLayer"></g>
        <g id="drawLayer"></g>
        <g id="selectionLayer"></g>
      </svg>
      <!-- Canvas for 3D (three.js) placed under SVG so SVG stays on top) -->
      <canvas id="threeCanvas" style="position:absolute;left:0;top:0;width:100%;height:100%;pointer-events:none;"></canvas>
    </div>
  </main>

  <script src="script.js"></script>
  <!-- Three.js integration and modules -->
  <script type="module" src="main.js"></script>
  

<<script type="module">
  // –Ü–º–ø–æ—Ä—Ç—É—î–º–æ ModelLoader
  import * as ModelLoader from './modelLoader.js';

  // –ß–µ–∫–∞—î–º–æ, –ø–æ–∫–∏ Three.js —Å—Ü–µ–Ω–∞ (THREE_APP) –±—É–¥–µ –≥–æ—Ç–æ–≤–∞
  function waitForThreeApp() {
    return new Promise(resolve => {
      const check = () => {
        if(window.THREE_APP) resolve(window.THREE_APP);
        else setTimeout(check, 50);
      };
      check();
    });
  }

  waitForThreeApp().then(THREE_APP => {
    console.log('Three.js –≥–æ—Ç–æ–≤–∏–π:', THREE_APP);

    // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ GLB –º–æ–¥–µ–ª—å
    ModelLoader.loadGLB('models/cube.glb', 'cube', obj => {
      console.log('Cube –¥–æ–¥–∞–Ω–∏–π —á–µ—Ä–µ–∑ ModelLoader:', obj);

      // –î–æ–¥–∞—î–º–æ –Ω–∞ —Å—Ü–µ–Ω—É
      if (THREE_APP.scene && obj) {
        THREE_APP.scene.add(obj);
      }
    });
  });
</script>

  
  <script type="module" src="bez-modulya.js"></script>
  <script type="module" src="biology.js"></script>
<style>
  .fab-fullscreen {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 56px;
    height: 56px;
    border: none;
    border-radius: 999px;
    background: rgba(28, 28, 33, 0.95);
    backdrop-filter: blur(6px);
    color: white;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 10px 24px rgba(0,0,0,0.35);
    cursor: grab;
    z-index: 9999;
    padding: 0;
    touch-action: none; /* –¥–ª—è –∫–æ—Ä–µ–∫—Ç–Ω–æ–≥–æ –ø–µ—Ä–µ—Ç—è–≥—É–≤–∞–Ω–Ω—è –Ω–∞ –º–æ–±—ñ–ª—å–Ω–∏—Ö */
    transition: transform .12s ease, box-shadow .12s ease, background .2s ease;
    user-select: none;
  }
  .fab-fullscreen:hover { transform: translateY(-1px); box-shadow: 0 12px 28px rgba(0,0,0,.4); }
  .fab-fullscreen:active { cursor: grabbing; transform: translateY(0); }
  .fab-fullscreen svg { width: 26px; height: 26px; display: block; }

  /* –º–∞–ª–µ–Ω—å–∫–∏–π –±–µ–π–¥–∂–∏–∫-–ø—ñ–¥–∫–∞–∑–∫–∞ (–æ–ø—Ü—ñ–π–Ω–æ) */
  .fab-hint {
    position: fixed;
    bottom: 84px;
    right: 20px;
    background: rgba(30,30,35,.9);
    color: #eee;
    font: 12px/1.2 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    padding: 6px 10px;
    border-radius: 8px;
    box-shadow: 0 8px 18px rgba(0,0,0,.35);
    z-index: 9999;
    opacity: 0;
    pointer-events: none;
    transform: translateY(6px);
    transition: opacity .18s ease, transform .18s ease;
  }
  .fab-fullscreen:hover + .fab-hint { opacity: 1; transform: translateY(0); }
</style>

<!-- –ü–ª–∞–≤–∞—é—á–∞ –∫–Ω–æ–ø–∫–∞ -->
<button id="fullscreenFab" class="fab-fullscreen" aria-label="–ü–µ—Ä–µ–º–∫–Ω—É—Ç–∏ –ø–æ–≤–Ω–æ–µ–∫—Ä–∞–Ω–Ω–∏–π —Ä–µ–∂–∏–º">
  <!-- –Ü–∫–æ–Ω–∫–∞ ¬´—Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–∏¬ª (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º) -->
  <svg id="iconExpand" viewBox="0 0 24 24" fill="none" aria-hidden="true">
    <path d="M4 10V4h6M4 4l6 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M14 4h6v6M20 4l-6 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M10 20H4v-6M4 20l6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M20 14v6h-6M20 20l-6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>
  <!-- –Ü–∫–æ–Ω–∫–∞ ¬´–∑–≥–æ—Ä–Ω—É—Ç–∏¬ª (–ø–æ–∫–∞–∑—É—î—Ç—å—Å—è —É fullscreen) -->
  <svg id="iconCompress" viewBox="0 0 24 24" fill="none" style="display:none" aria-hidden="true">
    <path d="M9 9H4v5M4 9l5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M15 9h5v5M20 9l-5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M9 15H4v-5M4 15l5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M15 15h5v-5M20 15l-5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>
</button>
<div class="fab-hint">–ö–ª—ñ–∫ ‚Äî fullscreen ‚Ä¢ –ü–µ—Ä–µ—Ç—è–≥–Ω–∏ ‚Äî –ø–µ—Ä–µ–º—ñ—Å—Ç–∏—Ç–∏</div>

<script>
(function(){
  const btn = document.getElementById('fullscreenFab');
  const iconExpand = document.getElementById('iconExpand');
  const iconCompress = document.getElementById('iconCompress');

  // –í—ñ–¥–Ω–æ–≤–∏—Ç–∏ –æ—Å—Ç–∞–Ω–Ω—é –ø–æ–∑–∏—Ü—ñ—é (localStorage)
  const saved = localStorage.getItem('fab-fullscreen-pos');
  if (saved) {
    try {
      const { left, top } = JSON.parse(saved);
      if (typeof left === 'number' && typeof top === 'number') {
        btn.style.left = left + 'px';
        btn.style.top = top + 'px';
        btn.style.right = 'auto';
        btn.style.bottom = 'auto';
      }
    } catch {}
  }

  // –•–µ–ª–ø–µ—Ä–∏ fullscreen
  function isFullscreen(){
    return !!(document.fullscreenElement || document.webkitFullscreenElement || document.msFullscreenElement);
  }
  function requestFS(el){
    if (el.requestFullscreen) return el.requestFullscreen();
    if (el.webkitRequestFullscreen) return el.webkitRequestFullscreen();
    if (el.msRequestFullscreen) return el.msRequestFullscreen();
  }
  function exitFS(){
    if (document.exitFullscreen) return document.exitFullscreen();
    if (document.webkitExitFullscreen) return document.webkitExitFullscreen();
    if (document.msExitFullscreen) return document.msExitFullscreen();
  }
  function syncIcon(){
    const fs = isFullscreen();
    iconExpand.style.display   = fs ? 'none' : '';
    iconCompress.style.display = fs ? '' : 'none';
    btn.setAttribute('aria-pressed', fs ? 'true' : 'false');
    btn.title = fs ? '–í–∏–π—Ç–∏ –∑ –ø–æ–≤–Ω–æ–µ–∫—Ä–∞–Ω–Ω–æ–≥–æ' : '–ù–∞ –≤–µ—Å—å –µ–∫—Ä–∞–Ω';
  }
  document.addEventListener('fullscreenchange', syncIcon);
  document.addEventListener('webkitfullscreenchange', syncIcon);
  document.addEventListener('msfullscreenchange', syncIcon);
  syncIcon();

  // –ö–ª—ñ–∫: toggle fullscreen
  let dragged = false;
  btn.addEventListener('click', (e) => {
    if (dragged) { dragged = false; return; } // —è–∫—â–æ —â–æ–π–Ω–æ –ø–µ—Ä–µ—Ç—è–≥—É–≤–∞–ª–∏ ‚Äî –Ω–µ —Ç–∏—Å–Ω–µ–º–æ
    if (!isFullscreen()) requestFS(document.documentElement);
    else exitFS();
  });

  // –ü–µ—Ä–µ—Ç—è–≥—É–≤–∞–Ω–Ω—è (Pointer Events)
  let startX=0, startY=0, startLeft=0, startTop=0, moved=false;

  const onPointerMove = (e) => {
    const dx = e.clientX - startX;
    const dy = e.clientY - startY;
    if (!moved && (Math.abs(dx) > 3 || Math.abs(dy) > 3)) { moved = true; dragged = true; }
    if (!moved) return;

    const left = startLeft + dx;
    const top  = startTop + dy;
    btn.style.left = left + 'px';
    btn.style.top  = top + 'px';
    btn.style.right = 'auto';
    btn.style.bottom = 'auto';
  };

  const onPointerUp = () => {
    btn.releasePointerCapture?.(event.pointerId);
    document.removeEventListener('pointermove', onPointerMove);
    document.removeEventListener('pointerup', onPointerUp);
    if (moved) {
      const rect = btn.getBoundingClientRect();
      localStorage.setItem('fab-fullscreen-pos', JSON.stringify({ left: rect.left, top: rect.top }));
    }
    setTimeout(()=>{ moved = false; }, 0);
  };

  btn.addEventListener('pointerdown', (e) => {
    startX = e.clientX;
    startY = e.clientY;
    const rect = btn.getBoundingClientRect();
    startLeft = rect.left;
    startTop  = rect.top;
    moved = false;
    btn.setPointerCapture?.(e.pointerId);
    document.addEventListener('pointermove', onPointerMove);
    document.addEventListener('pointerup', onPointerUp);
  });

  // –ó–∞–ø–æ–±—ñ–≥—Ç–∏ –ø—Ä–æ–∫—Ä—É—Ç—Ü—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –ø—ñ–¥ —á–∞—Å –ø–µ—Ä–µ—Ç—è–≥—É–≤–∞–Ω–Ω—è –Ω–∞ –º–æ–±—ñ–ª—å–Ω–∏—Ö
  btn.addEventListener('touchmove', (e)=> e.preventDefault(), { passive: false });
})();
</script>

</body>
</html>
