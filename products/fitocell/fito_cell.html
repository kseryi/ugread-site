<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D –ú–æ–¥–µ–ª—å –†–æ—Å–ª–∏–Ω–Ω–æ—ó –ö–ª—ñ—Ç–∏–Ω–∏</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0c3d2a 0%, #1a5c40 100%);
            color: #e8f5e9;
            min-height: 100vh;
            overflow: hidden;
        }
        
        #app {
            display: flex;
            height: 100vh;
            width: 100vw;
        }
        
        /* –ü–∞–Ω–µ–ª—å –∫–µ—Ä—É–≤–∞–Ω–Ω—è –∑–ª—ñ–≤–∞ */
        .control-panel {
            width: 350px;
            background: rgba(0, 20, 10, 0.85);
            backdrop-filter: blur(10px);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            padding: 25px;
            overflow-y: auto;
            z-index: 100;
            box-shadow: 5px 0 15px rgba(0, 0, 0, 0.3);
        }
        
        .control-panel h2 {
            color: #81c784;
            font-size: 1.8rem;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(129, 199, 132, 0.3);
        }
        
        .control-section {
            margin-bottom: 30px;
        }
        
        .control-section h3 {
            color: #a5d6a7;
            font-size: 1.2rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .control-section h3 i {
            font-size: 1.4rem;
        }
        
        .organelle-controls {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .organelle-btn {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 15px;
            background: rgba(76, 175, 80, 0.1);
            border: 1px solid rgba(76, 175, 80, 0.2);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .organelle-btn:hover {
            background: rgba(76, 175, 80, 0.15);
            transform: translateX(5px);
        }
        
        .organelle-btn.selected {
            background: rgba(76, 175, 80, 0.25);
            border-color: #4caf50;
            box-shadow: 0 0 10px rgba(76, 175, 80, 0.3);
        }
        
        .visibility-toggle {
            width: 18px;
            height: 18px;
            border-radius: 4px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            cursor: pointer;
            position: relative;
            transition: all 0.2s;
        }
        
        .visibility-toggle.visible::after {
            content: '‚úì';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #69f0ae;
            font-weight: bold;
            font-size: 12px;
        }
        
        .organelle-name {
            flex: 1;
            font-size: 0.95rem;
            color: #e8f5e9;
        }
        
        .organelle-status {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #69f0ae;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .organelle-btn.selected .organelle-status {
            opacity: 1;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 0.7; }
            50% { opacity: 1; }
            100% { opacity: 0.7; }
        }
        
        .slider-group {
            margin: 15px 0;
        }
        
        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            color: #c8e6c9;
            font-size: 0.9rem;
        }
        
        .slider {
            width: 100%;
            height: 6px;
            -webkit-appearance: none;
            appearance: none;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            outline: none;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #4caf50;
            cursor: pointer;
            border: 2px solid white;
        }
        
        .slider::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #4caf50;
            cursor: pointer;
            border: 2px solid white;
        }
        
        /* –ö–Ω–æ–ø–∫–∏ –∫–µ—Ä—É–≤–∞–Ω–Ω—è –ø–∞–Ω–µ–ª—è–º–∏ */
        .panel-toggle {
            position: fixed;
            top: 20px;
            z-index: 1000;
            background: rgba(0, 20, 10, 0.9);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.2rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            transition: all 0.3s;
        }
        
        .panel-toggle:hover {
            transform: scale(1.1);
            background: rgba(0, 30, 15, 0.9);
        }
        
        #toggle-controls {
            left: 20px;
        }
        
        #toggle-info {
            right: 20px;
        }
        
        /* –ü–∞–Ω–µ–ª—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó —Å–ø—Ä–∞–≤–∞ */
        .info-panel {
            width: 380px;
            background: rgba(0, 20, 10, 0.85);
            backdrop-filter: blur(10px);
            border-left: 1px solid rgba(255, 255, 255, 0.1);
            padding: 25px;
            overflow-y: auto;
            z-index: 100;
            box-shadow: -5px 0 15px rgba(0, 0, 0, 0.3);
            transform: translateX(0);
            transition: transform 0.4s ease;
        }
        
        .info-panel.collapsed {
            transform: translateX(100%);
        }
        
        .info-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(129, 199, 132, 0.3);
        }
        
        .info-header h2 {
            color: #81c784;
            font-size: 1.8rem;
        }
        
        .close-info {
            background: none;
            border: none;
            color: #81c784;
            font-size: 1.5rem;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        
        .close-info:hover {
            background: rgba(129, 199, 132, 0.1);
            transform: rotate(90deg);
        }
        
        .info-content {
            line-height: 1.6;
        }
        
        .info-content h3 {
            color: #a5d6a7;
            font-size: 1.4rem;
            margin: 20px 0 10px 0;
        }
        
        .info-content p {
            margin-bottom: 15px;
            font-size: 1rem;
        }
        
        .organelle-stats {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .organelle-stats h4 {
            color: #81c784;
            margin-bottom: 10px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .stat-item {
            font-size: 0.9rem;
        }
        
        .stat-label {
            color: #c8e6c9;
        }
        
        .stat-value {
            color: #69f0ae;
            font-weight: bold;
        }
        
        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è 3D —Å—Ü–µ–Ω–∏ */
        .scene-container {
            flex: 1;
            position: relative;
            overflow: hidden;
        }
        
        #cell-scene {
            width: 100%;
            height: 100%;
            cursor: grab;
        }
        
        #cell-scene:active {
            cursor: grabbing;
        }
        
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 1.2rem;
            text-align: center;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255, 255, 255, 0.1);
            border-top: 5px solid #4caf50;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω—ñ—Å—Ç—å */
        @media (max-width: 1200px) {
            .control-panel, .info-panel {
                width: 300px;
            }
        }
        
        @media (max-width: 900px) {
            .control-panel, .info-panel {
                position: fixed;
                height: 100%;
                top: 0;
                z-index: 1000;
            }
            
            .control-panel {
                left: 0;
                transform: translateX(0);
                transition: transform 0.4s ease;
            }
            
            .control-panel.collapsed {
                transform: translateX(-100%);
            }
            
            .info-panel {
                right: 0;
            }
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- –ü–∞–Ω–µ–ª—å –∫–µ—Ä—É–≤–∞–Ω–Ω—è –∑–ª—ñ–≤–∞ -->
        <div class="control-panel" id="controlPanel">
            <h2>–ö–µ—Ä—É–≤–∞–Ω–Ω—è –º–æ–¥–µ–ª–ª—é</h2>
            
            <div class="control-section">
                <h3><i>‚óè</i> –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –æ—Ä–≥–∞–Ω–µ–ª</h3>
                <div class="organelle-controls" id="organelleControls">
                    <!-- –û—Ä–≥–∞–Ω–µ–ª–∏ –±—É–¥—É—Ç—å –¥–æ–¥–∞–Ω—ñ —á–µ—Ä–µ–∑ JavaScript -->
                </div>
            </div>
            
            <div class="control-section">
                <h3><i>üé®</i> –ó–æ–≤–Ω—ñ—à–Ω—ñ–π –≤–∏–≥–ª—è–¥</h3>
                <div class="slider-group">
                    <div class="slider-label">
                        <span>–ü—Ä–æ–∑–æ—Ä—ñ—Å—Ç—å —Ü–∏—Ç–æ–ø–ª–∞–∑–º–∏:</span>
                        <span id="cytoplasmOpacityValue">0.1</span>
                    </div>
                    <input type="range" min="0" max="0.3" step="0.05" value="0.1" class="slider" id="cytoplasmOpacity">
                </div>
                
                <div class="organelle-controls" style="margin-top: 20px;">
                    <div class="organelle-btn" id="resetView" style="justify-content: center; background: rgba(76, 175, 80, 0.2);">
                        <span style="color: #e8f5e9; font-weight: bold;">–°–∫–∏–Ω—É—Ç–∏ –≤–∏–¥</span>
                    </div>
                    <div class="organelle-btn" id="autoRotate" style="justify-content: center; background: rgba(76, 175, 80, 0.2);">
                        <span style="color: #e8f5e9; font-weight: bold;">–ê–≤—Ç–æ–æ–±–µ—Ä—Ç–∞–Ω–Ω—è</span>
                        <div class="organelle-status" style="margin-left: 10px;"></div>
                    </div>
                </div>
            </div>
            
            <div class="control-section">
                <h3><i>‚öôÔ∏è</i> –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–∞–º–µ—Ä–∏</h3>
                <div class="slider-group">
                    <div class="slider-label">
                        <span>–ß—É—Ç–ª–∏–≤—ñ—Å—Ç—å –æ–±–µ—Ä—Ç–∞–Ω–Ω—è:</span>
                        <span id="cameraSensitivityValue">0.5</span>
                    </div>
                    <input type="range" min="0.1" max="1" step="0.1" value="0.5" class="slider" id="cameraSensitivity">
                </div>
            </div>
        </div>
        
        <!-- –ö–Ω–æ–ø–∫–∏ –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è –ø–∞–Ω–µ–ª–µ–π -->
        <button class="panel-toggle" id="toggle-controls">‚öôÔ∏è</button>
        <button class="panel-toggle" id="toggle-info">‚ÑπÔ∏è</button>
        
        <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è 3D —Å—Ü–µ–Ω–∏ -->
        <div class="scene-container">
            <div id="cell-scene">
                <div class="loading">
                    <div class="loading-spinner"></div>
                    –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è 3D –º–æ–¥–µ–ª—ñ...
                </div>
            </div>
        </div>
        
        <!-- –ü–∞–Ω–µ–ª—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó —Å–ø—Ä–∞–≤–∞ -->
        <div class="info-panel" id="infoPanel">
            <div class="info-header">
                <h2>–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è</h2>
                <button class="close-info" id="closeInfo">√ó</button>
            </div>
            <div class="info-content">
                <h3 id="elementName">–†–æ—Å–ª–∏–Ω–Ω–∞ –∫–ª—ñ—Ç–∏–Ω–∞</h3>
                <p id="elementDescription">–†–æ—Å–ª–∏–Ω–Ω–∞ –∫–ª—ñ—Ç–∏–Ω–∞ ‚Äî –æ—Å–Ω–æ–≤–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–∞ —Ç–∞ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–∞ –æ–¥–∏–Ω–∏—Ü—è —Ä–æ—Å–ª–∏–Ω.</p>
                <p id="elementFunction"><strong>–§—É–Ω–∫—Ü—ñ—è:</strong> –í–∏–∫–æ–Ω—É—î –≤—Å—ñ –∂–∏—Ç—Ç—î–≤—ñ –ø—Ä–æ—Ü–µ—Å–∏, –≤–∫–ª—é—á–∞—é—á–∏ —Ñ–æ—Ç–æ—Å–∏–Ω—Ç–µ–∑, –¥–∏—Ö–∞–Ω–Ω—è, —Å–∏–Ω—Ç–µ–∑ –±—ñ–ª–∫—ñ–≤ —Ç–∞ —Ä–æ–∑–º–Ω–æ–∂–µ–Ω–Ω—è.</p>
                
                
                
                <h3>–í–∑–∞—î–º–æ–¥—ñ—è –∑ –º–æ–¥–µ–ª–ª—é</h3>
                <p><strong>–õ—ñ–≤–∞ –∫–Ω–æ–ø–∫–∞ –º–∏—à—ñ:</strong> –û–±–µ—Ä—Ç–∞–Ω–Ω—è –∫–∞–º–µ—Ä–∏</p>
                <p><strong>–ö–æ–ª–µ—Å–æ –º–∏—à—ñ:</strong> –ó–±—ñ–ª—å—à–µ–Ω–Ω—è/–∑–º–µ–Ω—à–µ–Ω–Ω—è</p>
                <p><strong>–ö–ª—ñ–∫ –Ω–∞ –µ–ª–µ–º–µ–Ω—Ç:</strong> –í–∏–¥—ñ–ª–µ–Ω–Ω—è —Ç–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è</p>
                <p><strong>–ö–ª—ñ–∫ –Ω–∞ –ø–∞–Ω–µ–ª—ñ:</strong> –í–∏–±—ñ—Ä –æ—Ä–≥–∞–Ω–µ–ª–∏</p>
                <p><strong>–ö–ª—ñ–∫ —É –ø—Ä–æ—Å—Ç–æ—Ä—ñ:</strong> –°–∫–∏–¥–∞–Ω–Ω—è –≤–∏–¥—ñ–ª–µ–Ω–Ω—è</p>
            </div>
        </div>
    </div>

    <!-- –ü—ñ–¥–∫–ª—é—á–∞—î–º–æ Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.min.js"></script>
    
    <script>
        // –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –µ–ª–µ–º–µ–Ω—Ç–∏ –∫–ª—ñ—Ç–∏–Ω–∏
        const cellElementsInfo = {
            'cell-wall': {
                name: '–ö–ª—ñ—Ç–∏–Ω–Ω–∞ —Å—Ç—ñ–Ω–∫–∞',
                description: '–ó–æ–≤–Ω—ñ—à–Ω—ñ–π –∂–æ—Ä—Å—Ç–∫–∏–π —à–∞—Ä, —â–æ –æ—Ç–æ—á—É—î –∫–ª—ñ—Ç–∏–Ω–Ω—É –º–µ–º–±—Ä–∞–Ω—É —Ä–æ—Å–ª–∏–Ω–Ω–∏—Ö –∫–ª—ñ—Ç–∏–Ω. –°–∫–ª–∞–¥–∞—î—Ç—å—Å—è –ø–µ—Ä–µ–≤–∞–∂–Ω–æ –∑ —Ü–µ–ª—é–ª–æ–∑–∏.',
                function: '–ó–∞–±–µ–∑–ø–µ—á—É—î —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—É –ø—ñ–¥—Ç—Ä–∏–º–∫—É —Ç–∞ –∑–∞—Ö–∏—Å—Ç, –ø—ñ–¥—Ç—Ä–∏–º—É—î —Ñ–æ—Ä–º—É –∫–ª—ñ—Ç–∏–Ω–∏, –∑–∞–ø–æ–±—ñ–≥–∞—î –Ω–∞–¥–º—ñ—Ä–Ω–æ–º—É –ø–æ–≥–ª–∏–Ω–∞–Ω–Ω—é –≤–æ–¥–∏.'
            },
            'membrane': {
                name: '–ü–ª–∞–∑–º–∞—Ç–∏—á–Ω–∞ –º–µ–º–±—Ä–∞–Ω–∞',
                description: '–ù–∞–ø—ñ–≤–ø—Ä–æ–Ω–∏–∫–Ω–∞ –ª—ñ–ø—ñ–¥–Ω–∞ –±—ñ—à–∞—Ä–æ–≤–∞ –º–µ–º–±—Ä–∞–Ω–∞, —â–æ –æ—Ç–æ—á—É—î —Ü–∏—Ç–æ–ø–ª–∞–∑–º—É –∫–ª—ñ—Ç–∏–Ω–∏.',
                function: '–ö–æ–Ω—Ç—Ä–æ–ª—é—î —Ä—É—Ö —Ä–µ—á–æ–≤–∏–Ω –≤—Å–µ—Ä–µ–¥–∏–Ω—É —Ç–∞ –Ω–∞–∑–æ–≤–Ω—ñ –∫–ª—ñ—Ç–∏–Ω–∏, –∑–∞–±–µ–∑–ø–µ—á—É—î –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—é –º—ñ–∂ –∫–ª—ñ—Ç–∏–Ω–∞–º–∏, –ø—ñ–¥—Ç—Ä–∏–º—É—î –≥–æ–º–µ–æ—Å—Ç–∞–∑.'
            },
            'cytoplasm': {
                name: '–¶–∏—Ç–æ–ø–ª–∞–∑–º–∞',
                description: '–ì–µ–ª–µ–ø–æ–¥—ñ–±–Ω–∞ —Ä–µ—á–æ–≤–∏–Ω–∞ (—Ü–∏—Ç–æ–∑–æ–ª—å), —â–æ –∑–∞–ø–æ–≤–Ω—é—î –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π –ø—Ä–æ—Å—Ç—ñ—Ä –∫–ª—ñ—Ç–∏–Ω–∏ –º—ñ–∂ —è–¥—Ä–æ–º —Ç–∞ –∫–ª—ñ—Ç–∏–Ω–Ω–æ—é –º–µ–º–±—Ä–∞–Ω–æ—é.',
                function: '–°–ª—É–∂–∏—Ç—å —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ–º –¥–ª—è –æ—Ä–≥–∞–Ω–µ–ª, –∑–∞–±–µ–∑–ø–µ—á—É—î —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç –ø–æ–∂–∏–≤–Ω–∏—Ö —Ä–µ—á–æ–≤–∏–Ω —ñ –≤—ñ–¥—Ö–æ–¥—ñ–≤ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–ª—ñ—Ç–∏–Ω–∏.'
            },
            'nucleus': {
                name: '–Ø–¥—Ä–æ',
                description: '–ù–∞–π–±—ñ–ª—å—à–∞ –æ—Ä–≥–∞–Ω–µ–ª–∞ –∫–ª—ñ—Ç–∏–Ω–∏, —â–æ –º—ñ—Å—Ç–∏—Ç—å –≥–µ–Ω–µ—Ç–∏—á–Ω–∏–π –º–∞—Ç–µ—Ä—ñ–∞–ª (–î–ù–ö). –û—Ç–æ—á–µ–Ω–µ —è–¥–µ—Ä–Ω–æ—é –æ–±–æ–ª–æ–Ω–∫–æ—é.',
                function: '–ö–æ–Ω—Ç—Ä–æ–ª—é—î –≤—Å—ñ –∫–ª—ñ—Ç–∏–Ω–Ω—ñ –ø—Ä–æ—Ü–µ—Å–∏, –≤–∫–ª—é—á–∞—é—á–∏ —Ä—ñ—Å—Ç, –º–µ—Ç–∞–±–æ–ª—ñ–∑–º —Ç–∞ —Ä–æ–∑–º–Ω–æ–∂–µ–Ω–Ω—è. –ú—ñ—Å—Ç–∏—Ç—å —Ö—Ä–æ–º–æ—Å–æ–º–∏ –∑ –≥–µ–Ω–µ—Ç–∏—á–Ω–æ—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é.'
            },
            'chloroplasts': {
                name: '–•–ª–æ—Ä–æ–ø–ª–∞—Å—Ç–∏',
                description: '–ü–ª–∞—Å—Ç–∏–¥–∏, —â–æ –º—ñ—Å—Ç—è—Ç—å —Ö–ª–æ—Ä–æ—Ñ—ñ–ª —ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –∑–∞ —Ñ–æ—Ç–æ—Å–∏–Ω—Ç–µ–∑. –ú–∞—é—Ç—å –≤–ª–∞—Å–Ω—É –î–ù–ö.',
                function: '–ü–µ—Ä–µ—Ç–≤–æ—Ä—é—é—Ç—å —Å–æ–Ω—è—á–Ω—É –µ–Ω–µ—Ä–≥—ñ—é –Ω–∞ —Ö—ñ–º—ñ—á–Ω—É –µ–Ω–µ—Ä–≥—ñ—é (–≥–ª—é–∫–æ–∑—É) –≤ –ø—Ä–æ—Ü–µ—Å—ñ —Ñ–æ—Ç–æ—Å–∏–Ω—Ç–µ–∑—É.'
            },
            'vacuole': {
                name: '–í–∞–∫—É–æ–ª—å –∑ –∫–ª—ñ—Ç–∏–Ω–Ω–∏–º —Å–æ–∫–æ–º',
                description: '–í–µ–ª–∏–∫–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞ –≤–∞–∫—É–æ–ª—å, –∑–∞–ø–æ–≤–Ω–µ–Ω–∞ —Ä—ñ–¥–∏–Ω–æ—é (–∫–ª—ñ—Ç–∏–Ω–Ω–∏–º —Å–æ–∫–æ–º). –ó–∞–π–º–∞—î –¥–æ 90% –æ–±\'—î–º—É –∫–ª—ñ—Ç–∏–Ω–∏.',
                function: '–ó–±–µ—Ä—ñ–≥–∞—î –≤–æ–¥—É, –ø–æ–∂–∏–≤–Ω—ñ —Ä–µ—á–æ–≤–∏–Ω–∏, —ñ–æ–Ω–∏ —Ç–∞ –≤—ñ–¥—Ö–æ–¥–∏. –ü—ñ–¥—Ç—Ä–∏–º—É—î —Ç—É—Ä–≥–æ—Ä–Ω–∏–π —Ç–∏—Å–∫, —â–æ –¥–æ–ø–æ–º–∞–≥–∞—î –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞—Ç–∏ —Ñ–æ—Ä–º—É –∫–ª—ñ—Ç–∏–Ω–∏.'
            },
            'mitochondria': {
                name: '–ú—ñ—Ç–æ—Ö–æ–Ω–¥—Ä—ñ—ó',
                description: '–û—Ä–≥–∞–Ω–µ–ª–∏, —è–∫—ñ —î "–µ–Ω–µ—Ä–≥–µ—Ç–∏—á–Ω–∏–º–∏ —Å—Ç–∞–Ω—Ü—ñ—è–º–∏" –∫–ª—ñ—Ç–∏–Ω–∏. –ú–∞—é—Ç—å –≤–ª–∞—Å–Ω—É –î–ù–ö.',
                function: '–í–∏—Ä–æ–±–ª—è—é—Ç—å –µ–Ω–µ—Ä–≥—ñ—é (–ê–¢–§) –≤ –ø—Ä–æ—Ü–µ—Å—ñ –∫–ª—ñ—Ç–∏–Ω–Ω–æ–≥–æ –¥–∏—Ö–∞–Ω–Ω—è —à–ª—è—Ö–æ–º —Ä–æ–∑—â–µ–ø–ª–µ–Ω–Ω—è –≥–ª—é–∫–æ–∑–∏.'
            },
            'ribosomes': {
                name: '–†–∏–±–æ—Å–æ–º–∏',
                description: '–ù–µ–≤–µ–ª–∏–∫—ñ –Ω—É–∫–ª–µ–æ–ø—Ä–æ—Ç–µ—ó–Ω–æ–≤—ñ –∫–æ–º–ø–ª–µ–∫—Å–∏, —â–æ —Å–∫–ª–∞–¥–∞—é—Ç—å—Å—è –∑ –†–ù–ö —Ç–∞ –±—ñ–ª–∫—ñ–≤.',
                function: '–°–∏–Ω—Ç–µ–∑—É—é—Ç—å –±—ñ–ª–∫–∏ —à–ª—è—Ö–æ–º —Ç—Ä–∞–Ω—Å–ª—è—Ü—ñ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –∑ –º–†–ù–ö.'
            },
            'endoplasmic': {
                name: '–ï–Ω–¥–æ–ø–ª–∞–∑–º–∞—Ç–∏—á–Ω–∞ —Å—ñ—Ç–∫–∞',
                description: '–°–∏—Å—Ç–µ–º–∞ –≤–∑–∞—î–º–æ–ø–æ–≤\'—è–∑–∞–Ω–∏—Ö –º–µ–º–±—Ä–∞–Ω–Ω–∏—Ö –∫–∞–Ω–∞–ª—ñ–≤ —É —Ü–∏—Ç–æ–ø–ª–∞–∑–º—ñ.',
                function: '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç—É—î –±—ñ–ª–∫–∏ —Ç–∞ –ª—ñ–ø—ñ–¥–∏ –º—ñ–∂ –æ—Ä–≥–∞–Ω–µ–ª–∞–º–∏, –±–µ—Ä–µ —É—á–∞—Å—Ç—å —É —Å–∏–Ω—Ç–µ–∑—ñ –±—ñ–ª–∫—ñ–≤ —Ç–∞ –ª—ñ–ø—ñ–¥—ñ–≤, –¥–µ—Ç–æ–∫—Å–∏–∫–∞—Ü—ñ—è.'
            },
            'golgi': {
                name: '–ö–æ–º–ø–ª–µ–∫—Å –ì–æ–ª—å–¥–∂—ñ',
                description: '–°–∫–ª–∞–¥–æ–≤–∞ —Å–∏—Å—Ç–µ–º–∞ –º–µ–º–±—Ä–∞–Ω–Ω–∏—Ö —Ü–∏—Å—Ç–µ—Ä–Ω, —â–æ –±–µ—Ä–µ —É—á–∞—Å—Ç—å —É –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—ó, —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—ñ —Ç–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç—É–≤–∞–Ω–Ω—ñ –±—ñ–ª–∫—ñ–≤.',
                function: '–ú–æ–¥–∏—Ñ—ñ–∫—É—î, —Å–æ—Ä—Ç—É—î —Ç–∞ —É–ø–∞–∫–æ–≤—É—î –±—ñ–ª–∫–∏ –¥–ª—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç—É–≤–∞–Ω–Ω—è –¥–æ –∫—ñ–Ω—Ü–µ–≤–∏—Ö –º—ñ—Å—Ü—å –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è.'
            }
        };

        // –û—Å–Ω–æ–≤–Ω—ñ –∑–º—ñ–Ω–Ω—ñ Three.js
        let scene, camera, renderer, controls;
        let cellElements = {};
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
        let settings = {
            autoRotate: false,
            cameraSensitivity: 0.5
        };
        
        // –°—Ç–∞–Ω –¥–æ–¥–∞—Ç–∫—É
        let state = {
            selectedElement: null,
            highlightedElement: null,
            originalMaterials: new Map(),
            organelleVisibility: {}
        };
        
        // –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–ø–∏—Å–∫—É –æ—Ä–≥–∞–Ω–µ–ª
        function createOrganelleControls() {
            const container = document.getElementById('organelleControls');
            
            for (const [id, info] of Object.entries(cellElementsInfo)) {
                const btn = document.createElement('div');
                btn.className = 'organelle-btn';
                btn.dataset.id = id;
                
                // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î–º–æ –≤–∏–¥–∏–º—ñ—Å—Ç—å
                state.organelleVisibility[id] = true;
                
                btn.innerHTML = `
                    <div class="visibility-toggle visible"></div>
                    <div class="organelle-name">${info.name}</div>
                    <div class="organelle-status"></div>
                `;
                
                container.appendChild(btn);
                
                // –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫–∏ –ø–æ–¥—ñ–π
                const visibilityToggle = btn.querySelector('.visibility-toggle');
                visibilityToggle.addEventListener('click', function(e) {
                    e.stopPropagation();
                    toggleOrganelleVisibility(id);
                });
                
                btn.addEventListener('click', function(e) {
                    if (e.target !== visibilityToggle) {
                        selectOrganelle(id);
                    }
                });
            }
        }
        
        // –ü–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è –≤–∏–¥–∏–º–æ—Å—Ç—ñ –æ—Ä–≥–∞–Ω–µ–ª–∏
        function toggleOrganelleVisibility(organelleId) {
            const toggle = document.querySelector(`[data-id="${organelleId}"] .visibility-toggle`);
            const isVisible = toggle.classList.contains('visible');
            
            if (isVisible) {
                toggle.classList.remove('visible');
                hideElement(organelleId);
                state.organelleVisibility[organelleId] = false;
                
                // –Ø–∫—â–æ –≤–∏–º–∫–Ω—É–ª–∏ –æ–±—Ä–∞–Ω—É –æ—Ä–≥–∞–Ω–µ–ª—É, –∑–Ω—ñ–º–∞—î–º–æ –≤–∏–¥—ñ–ª–µ–Ω–Ω—è
                if (state.selectedElement === organelleId) {
                    clearSelection();
                }
            } else {
                toggle.classList.add('visible');
                showElement(organelleId);
                state.organelleVisibility[organelleId] = true;
            }
        }
        
        // –í–∏–±—ñ—Ä –æ—Ä–≥–∞–Ω–µ–ª–∏
        function selectOrganelle(organelleId) {
            // –í–∏–¥–∞–ª—è—î–º–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—î –≤–∏–¥—ñ–ª–µ–Ω–Ω—è
            clearSelection();
            
            // –î–æ–¥–∞—î–º–æ –≤–∏–¥—ñ–ª–µ–Ω–Ω—è –Ω–∞ —Å–ø–∏—Å–∫—É
            const btn = document.querySelector(`[data-id="${organelleId}"]`);
            btn.classList.add('selected');
            
            // –û–Ω–æ–≤–ª—é—î–º–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é
            showElementInfo(organelleId);
            
            // –í—ñ–¥–∫—Ä–∏–≤–∞—î–º–æ –ø—Ä–∞–≤—É –ø–∞–Ω–µ–ª—å, —è–∫—â–æ –≤–æ–Ω–∞ –∑–∞–∫—Ä–∏—Ç–∞
            document.getElementById('infoPanel').classList.remove('collapsed');
            
            // –ü—ñ–¥—Å–≤—ñ—á—É—î–º–æ –æ—Ä–≥–∞–Ω–µ–ª—É –≤ —Å—Ü–µ–Ω—ñ
            highlightOrganelle(organelleId);
            
            // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –æ–±—Ä–∞–Ω–∏–π –µ–ª–µ–º–µ–Ω—Ç
            state.selectedElement = organelleId;
        }
        
        // –°–∫–∏–¥–∞–Ω–Ω—è –≤–∏–¥—ñ–ª–µ–Ω–Ω—è
        function clearSelection() {
            // –í–∏–¥–∞–ª—è—î–º–æ –≤–∏–¥—ñ–ª–µ–Ω–Ω—è –∑—ñ —Å–ø–∏—Å–∫—É
            document.querySelectorAll('.organelle-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            // –í–∏–¥–∞–ª—è—î–º–æ –ø—ñ–¥—Å–≤—ñ—á—É–≤–∞–Ω–Ω—è
            removeHighlight();
            
            // –ü–æ–∫–∞–∑—É—î–º–æ –∑–∞–≥–∞–ª—å–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é
            showDefaultInfo();
            
            // –°–∫–∏–¥–∞—î–º–æ –≤–∏–±—Ä–∞–Ω–∏–π –µ–ª–µ–º–µ–Ω—Ç
            state.selectedElement = null;
        }
        
        // –ü—ñ–¥—Å–≤—ñ—á—É–≤–∞–Ω–Ω—è –æ—Ä–≥–∞–Ω–µ–ª–∏
        function highlightOrganelle(organelleId) {
            // –í–∏–¥–∞–ª—è—î–º–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—î –ø—ñ–¥—Å–≤—ñ—á—É–≤–∞–Ω–Ω—è
            removeHighlight();
            
            if (!cellElements[organelleId] || !state.organelleVisibility[organelleId]) return;
            
            // –ü—ñ–¥—Å–≤—ñ—á—É—î–º–æ –æ—Å–Ω–æ–≤–Ω–∏–π –æ–±'—î–∫—Ç
            const object = cellElements[organelleId];
            highlightObject(object);
            state.highlightedElement = organelleId;
            
            // –ü—ñ–¥—Å–≤—ñ—á—É—î–º–æ –≤—Å—ñ –æ–±'—î–∫—Ç–∏ —Ü—ñ—î—ó –æ—Ä–≥–∞–Ω–µ–ª–∏
            scene.traverse((obj) => {
                if (obj.name && obj.name.startsWith(organelleId) && obj !== object) {
                    highlightObject(obj);
                }
            });
        }
        
        // –ü—ñ–¥—Å–≤—ñ—á—É–≤–∞–Ω–Ω—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –æ–±'—î–∫—Ç–∞
        function highlightObject(object) {
            if (!object.material) return;
            
            // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π –º–∞—Ç–µ—Ä—ñ–∞–ª
            if (!state.originalMaterials.has(object)) {
                state.originalMaterials.set(object, {
                    emissive: object.material.emissive ? object.material.emissive.getHex() : 0x000000,
                    emissiveIntensity: object.material.emissiveIntensity || 0
                });
            }
            
            // –ü—ñ–¥—Å–≤—ñ—á—É—î–º–æ
            if (object.material.emissive) {
                object.material.emissive.setHex(0xFFFFFF);
                object.material.emissiveIntensity = 0.5;
            }
        }
        
        // –í–∏–¥–∞–ª–µ–Ω–Ω—è –ø—ñ–¥—Å–≤—ñ—á—É–≤–∞–Ω–Ω—è
        function removeHighlight() {
            if (!state.highlightedElement) return;
            
            // –í—ñ–¥–Ω–æ–≤–ª—é—î–º–æ –≤—Å—ñ –º–∞—Ç–µ—Ä—ñ–∞–ª–∏
            state.originalMaterials.forEach((original, object) => {
                if (object.material) {
                    if (object.material.emissive) {
                        object.material.emissive.setHex(original.emissive);
                        object.material.emissiveIntensity = original.emissiveIntensity;
                    }
                }
            });
            
            state.originalMaterials.clear();
            state.highlightedElement = null;
        }
        
        // –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —à–µ—Å—Ç–∏–∫—É—Ç–Ω–∏–∫–∞ –∑—ñ —Å–∫—Ä—É–≥–ª–µ–Ω–∏–º–∏ –∫—É—Ç–∞–º–∏
        function createRoundedHexagonGeometry(radius, height, cornerRadius = 0.5) {
            const shape = new THREE.Shape();
            const sides = 6;
            const angleStep = (Math.PI * 2) / sides;
            
            // –ü–æ—á–∏–Ω–∞—î–º–æ –∑ –ø–µ—Ä—à–æ—ó —Ç–æ—á–∫–∏
            for (let i = 0; i < sides; i++) {
                const angle = i * angleStep;
                const x = Math.cos(angle) * radius;
                const y = Math.sin(angle) * radius;
                
                if (i === 0) {
                    shape.moveTo(x, y);
                } else {
                    shape.lineTo(x, y);
                }
            }
            
            shape.closePath();
            
            // –î–æ–¥–∞—î–º–æ —Å–∫—Ä—É–≥–ª–µ–Ω–Ω—è –∫—É—Ç—ñ–≤
            const roundedShape = new THREE.Shape();
            const vertices = shape.getPoints();
            const numPoints = vertices.length;
            
            for (let i = 0; i < numPoints; i++) {
                const p1 = vertices[i];
                const p2 = vertices[(i + 1) % numPoints];
                const p3 = vertices[(i + 2) % numPoints];
                
                // –û–±—á–∏—Å–ª—é—î–º–æ –≤–µ–∫—Ç–æ—Ä –≤—ñ–¥ p1 –¥–æ p2
                const v1 = new THREE.Vector2().subVectors(p2, p1);
                const v2 = new THREE.Vector2().subVectors(p3, p2);
                
                // –ù–æ—Ä–º–∞–ª—ñ–∑—É—î–º–æ –≤–µ–∫—Ç–æ—Ä–∏
                v1.normalize();
                v2.normalize();
                
                // –û–±—á–∏—Å–ª—é—î–º–æ –±—ñ—Å–µ–∫—Ç—Ä–∏—Å—É –∫—É—Ç–∞
                const bisector = new THREE.Vector2().addVectors(v1, v2).normalize();
                
                // –û–±—á–∏—Å–ª—é—î–º–æ —Ç–æ—á–∫—É —Å–∫—Ä—É–≥–ª–µ–Ω–Ω—è
                const cornerPoint = new THREE.Vector2().addVectors(
                    p2,
                    bisector.multiplyScalar(-cornerRadius / Math.cos(Math.PI / sides))
                );
                
                if (i === 0) {
                    roundedShape.moveTo(cornerPoint.x, cornerPoint.y);
                }
                
                // –î–æ–¥–∞—î–º–æ –¥—É–≥—É
                const controlPoint1 = new THREE.Vector2().addVectors(p2, v1.multiplyScalar(-cornerRadius));
                const controlPoint2 = new THREE.Vector2().addVectors(p2, v2.multiplyScalar(cornerRadius));
                
                roundedShape.quadraticCurveTo(controlPoint1.x, controlPoint1.y, cornerPoint.x, cornerPoint.y);
                roundedShape.quadraticCurveTo(controlPoint2.x, controlPoint2.y, controlPoint2.x, controlPoint2.y);
            }
            
            roundedShape.closePath();
            
            // –ï–∫—Å—Ç—Ä—É–¥—É—î–º–æ —Ñ–æ—Ä–º—É
            const extrudeSettings = {
                depth: height,
                bevelEnabled: false,
                curveSegments: 24
            };
            
            return new THREE.ExtrudeGeometry(roundedShape, extrudeSettings);
        }
        
        // –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ–º–ø–ª–µ–∫—Å—É –ì–æ–ª—å–¥–∂—ñ
        function createGolgiComplex() {
            const group = new THREE.Group();
            group.name = 'golgi';
            
            // –°—Ç–≤–æ—Ä—é—î–º–æ –∫—ñ–ª—å–∫–∞ —Ü–∏—Å—Ç–µ—Ä–Ω (—à–∞—Ä—ñ–≤)
            const layers = 5;
            const layerSpacing = 0.3;
            
            for (let i = 0; i < layers; i++) {
                const radius = 1.5 - (i * 0.2);
                const height = 0.1;
                
                const cylinderGeometry = new THREE.CylinderGeometry(radius, radius, height, 32);
                const cylinderMaterial = new THREE.MeshPhongMaterial({ 
                    color: 0x4300E8,
                    transparent: true,
                    opacity: 0.8
                });
                
                const layer = new THREE.Mesh(cylinderGeometry, cylinderMaterial);
                layer.position.y = i * layerSpacing;
                
                if (i > 0) {
                    layer.rotation.x = Math.sin(i * 0.5) * 0.1;
                    layer.rotation.z = Math.cos(i * 0.5) * 0.1;
                }
                
                group.add(layer);
            }
            
            // –î–æ–¥–∞—î–º–æ –≤–µ–∑–∏–∫—É–ª–∏ –Ω–∞–≤–∫–æ–ª–æ
            for (let i = 0; i < 8; i++) {
                const angle = (i / 8) * Math.PI * 2;
                const distance = 2.0;
                const x = Math.cos(angle) * distance;
                const z = Math.sin(angle) * distance;
                const y = Math.random() * layers * layerSpacing;
                
                const vesicleGeometry = new THREE.SphereGeometry(0.15, 8, 8);
                const vesicleMaterial = new THREE.MeshPhongMaterial({ 
                    color: 0x4300E8
                });
                
                const vesicle = new THREE.Mesh(vesicleGeometry, vesicleMaterial);
                vesicle.position.set(x, y, z);
                group.add(vesicle);
            }
            
            return group;
        }
        
        // –ü–æ–∫–∞–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó
        function showDefaultInfo() {
            document.getElementById('elementName').textContent = '–†–æ—Å–ª–∏–Ω–Ω–∞ –∫–ª—ñ—Ç–∏–Ω–∞';
            document.getElementById('elementDescription').textContent = '–†–æ—Å–ª–∏–Ω–Ω–∞ –∫–ª—ñ—Ç–∏–Ω–∞ ‚Äî –æ—Å–Ω–æ–≤–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–∞ —Ç–∞ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–∞ –æ–¥–∏–Ω–∏—Ü—è —Ä–æ—Å–ª–∏–Ω. –í–æ–Ω–∞ –º–∞—î —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—É —à–µ—Å—Ç–∏–∫—É—Ç–Ω—É —Ñ–æ—Ä–º—É –∑—ñ —Å–∫—Ä—É–≥–ª–µ–Ω–∏–º–∏ –∫—É—Ç–∞–º–∏, —â–æ –¥–æ–∑–≤–æ–ª—è—î —â—ñ–ª—å–Ω–æ –ø—Ä–∏–ª—è–≥–∞—Ç–∏ –¥–æ —Å—É—Å—ñ–¥–Ω—ñ—Ö –∫–ª—ñ—Ç–∏–Ω.';
            document.getElementById('elementFunction').innerHTML = '<strong>–§—É–Ω–∫—Ü—ñ—è:</strong> –í–∏–∫–æ–Ω—É—î –≤—Å—ñ –∂–∏—Ç—Ç—î–≤—ñ –ø—Ä–æ—Ü–µ—Å–∏, –≤–∫–ª—é—á–∞—é—á–∏ —Ñ–æ—Ç–æ—Å–∏–Ω—Ç–µ–∑, –¥–∏—Ö–∞–Ω–Ω—è, —Å–∏–Ω—Ç–µ–∑ –±—ñ–ª–∫—ñ–≤ —Ç–∞ —Ä–æ–∑–º–Ω–æ–∂–µ–Ω–Ω—è.';
        }
        
        // –ü–æ–∫–∞–∑ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –µ–ª–µ–º–µ–Ω—Ç
        function showElementInfo(elementName) {
            const baseName = elementName.replace(/\d+$/, '');
            
            if (cellElementsInfo[baseName]) {
                const info = cellElementsInfo[baseName];
                document.getElementById('elementName').textContent = info.name;
                document.getElementById('elementDescription').textContent = info.description;
                document.getElementById('elementFunction').innerHTML = `<strong>–§—É–Ω–∫—Ü—ñ—è:</strong> ${info.function}`;
            }
        }
        
        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —Å—Ü–µ–Ω–∏
        function init() {
            // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ Three.js
            if (typeof THREE === 'undefined') {
                document.querySelector('.loading').innerHTML = '–ü–æ–º–∏–ª–∫–∞: Three.js –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏–≤—Å—è.';
                return;
            }
            
            // –í–∏–¥–∞–ª—è—î–º–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
            const loadingElement = document.querySelector('.loading');
            if (loadingElement) loadingElement.style.display = 'none';
            
            // –°—Ç–≤–æ—Ä—é—î–º–æ —Å–ø–∏—Å–æ–∫ –æ—Ä–≥–∞–Ω–µ–ª
            createOrganelleControls();
            
            // –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å—Ü–µ–Ω–∏
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x0a291d);
            
            // –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–∞–º–µ—Ä–∏
            const container = document.getElementById('cell-scene');
            camera = new THREE.PerspectiveCamera(45, container.clientWidth / container.clientHeight, 0.1, 1000);
            camera.position.set(25, 20, 25);
            
            // –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ä–µ–Ω–¥–µ—Ä–µ—Ä–∞
            renderer = new THREE.WebGLRenderer({ 
                antialias: true, 
                alpha: true,
                powerPreference: "high-performance"
            });
            renderer.setSize(container.clientWidth, container.clientHeight);
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;
            container.appendChild(renderer.domElement);
            
            // –î–æ–¥–∞–≤–∞–Ω–Ω—è –∫–æ–Ω—Ç—Ä–æ–ª—ñ–≤ –¥–ª—è –æ–±–µ—Ä—Ç–∞–Ω–Ω—è –∫–∞–º–µ—Ä–∏
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            controls.minDistance = 15;
            controls.maxDistance = 60;
            controls.rotateSpeed = settings.cameraSensitivity;
            
            // –î–æ–¥–∞–≤–∞–Ω–Ω—è –æ—Å–≤—ñ—Ç–ª–µ–Ω–Ω—è
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
            scene.add(ambientLight);
            
            const directionalLight1 = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight1.position.set(20, 30, 15);
            directionalLight1.castShadow = true;
            scene.add(directionalLight1);
            
            const directionalLight2 = new THREE.DirectionalLight(0xffffff, 0.4);
            directionalLight2.position.set(-20, 20, -15);
            scene.add(directionalLight2);
            
            // –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ —Ä–æ—Å–ª–∏–Ω–Ω–æ—ó –∫–ª—ñ—Ç–∏–Ω–∏
            createPlantCell();
            
            // –û–±—Ä–æ–±–∫–∞ –ø–æ–¥—ñ–π –º–∏—à—ñ
            setupMouseEvents();
            
            // –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–µ—Ä—É–≤–∞–Ω–Ω—è
            setupControls();
            
            // –ê–Ω—ñ–º–∞—Ü—ñ—è
            animate();
            
            // –û–±—Ä–æ–±–∫–∞ –∑–º—ñ–Ω–∏ —Ä–æ–∑–º—ñ—Ä—É –≤—ñ–∫–Ω–∞
            window.addEventListener('resize', onWindowResize);
            
            // –û–±—Ä–æ–±–∫–∞ –∫–ª—ñ–∫—É –∑–∞ –º–µ–∂–∞–º–∏ –¥–ª—è —Å–∫–∏–¥–∞–Ω–Ω—è –≤–∏–¥—ñ–ª–µ–Ω–Ω—è
            renderer.domElement.addEventListener('click', function(event) {
                const raycaster = new THREE.Raycaster();
                const mouse = new THREE.Vector2();
                const rect = renderer.domElement.getBoundingClientRect();
                
                mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;
                mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;
                
                raycaster.setFromCamera(mouse, camera);
                const intersects = raycaster.intersectObjects(scene.children, true);
                
                // –Ø–∫—â–æ –∫–ª—ñ–∫–Ω—É–ª–∏ –≤ –ø—É—Å—Ç–µ –º—ñ—Å—Ü–µ
                if (intersects.length === 0 && !event.target.closest('.control-panel') && !event.target.closest('.panel-toggle')) {
                    clearSelection();
                }
            });
        }
        
        // –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ —Ä–æ—Å–ª–∏–Ω–Ω–æ—ó –∫–ª—ñ—Ç–∏–Ω–∏
        function createPlantCell() {
            try {
                const cellRadius = 8;  // –ó–±—ñ–ª—å—à—É—î–º–æ —Ä–∞–¥—ñ—É—Å –¥–ª—è –±—ñ–ª—å—à–æ—ó –∫–ª—ñ—Ç–∏–Ω–∏
                const cellHeight = 12;
                const centerY = cellHeight / 2;
                const centerZ = -6
                
                // –ö–ª—ñ—Ç–∏–Ω–Ω–∞ —Å—Ç—ñ–Ω–∫–∞ (—à–µ—Å—Ç–∏–∫—É—Ç–Ω–∏–∫ –∑—ñ —Å–∫—Ä—É–≥–ª–µ–Ω–∏–º–∏ –∫—É—Ç–∞–º–∏)
                const wallGeometry = createRoundedHexagonGeometry(cellRadius, cellHeight, 0.8);
                const wallMaterial = new THREE.MeshPhongMaterial({ 
                    color: 0x8BC34A,
                    transparent: true,
                    opacity: 0.6,
                    side: THREE.DoubleSide
                });
                const cellWall = new THREE.Mesh(wallGeometry, wallMaterial);
                cellWall.name = 'cell-wall';
                cellWall.position.y = centerY;
                cellWall.position.z = -6.1;
                scene.add(cellWall);
                cellElements['cell-wall'] = cellWall;
                
                // –ü–ª–∞–∑–º–∞—Ç–∏—á–Ω–∞ –º–µ–º–±—Ä–∞–Ω–∞ (–≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Å—Ç—ñ–Ω–∫–∏, —Ç—Ä–æ—Ö–∏ –º–µ–Ω—à–∞)
                const membraneGeometry = createRoundedHexagonGeometry(cellRadius * 0.9, cellHeight * 0.99, 0.7);
                const membraneMaterial = new THREE.MeshPhongMaterial({ 
                    color: 0xFF9800,
                    transparent: true,
                    opacity: 0.5,
                    side: THREE.DoubleSide
                });
                const membrane = new THREE.Mesh(membraneGeometry, membraneMaterial);
                membrane.name = 'membrane';
                membrane.position.y = centerY;
                membrane.position.z = centerZ;
                scene.add(membrane);
                cellElements['membrane'] = membrane;
                
                // –¶–∏—Ç–æ–ø–ª–∞–∑–º–∞ (–Ω–∞–ø—ñ–≤–ø—Ä–æ–∑–æ—Ä–∞ –≤–Ω—É—Ç—Ä—ñ—à–Ω—è —á–∞—Å—Ç–∏–Ω–∞)
                const cytoplasmGeometry = createRoundedHexagonGeometry(cellRadius * 0.85, cellHeight * 0.85, 0.6);
                const cytoplasmMaterial = new THREE.MeshPhongMaterial({ 
                    color: 0xFFFFFF,
                    transparent: true,
                    opacity: 0.1,
                    side: THREE.DoubleSide
                });
                const cytoplasm = new THREE.Mesh(cytoplasmGeometry, cytoplasmMaterial);
                cytoplasm.name = 'cytoplasm';
                cytoplasm.position.y = centerY;
                cytoplasm.position.z = -6;
                scene.add(cytoplasm);
                cellElements['cytoplasm'] = cytoplasm;
                
                // –í–ê–ö–£–û–õ–¨ - –Ω–µ–ø—Ä–æ–∑–æ—Ä–∞ –ø—Ä–∏–ø–ª—é—Å–Ω—É—Ç–∞ —Å—Ñ–µ—Ä–∞
                const vacuoleGeometry = new THREE.SphereGeometry(2, 32, 32);
                const vacuoleMaterial = new THREE.MeshPhongMaterial({ 
                    color: 0x9C27B0,
                    transparent: false,  // –ù–µ–ø—Ä–æ–∑–æ—Ä–∞!
                    opacity: 1.0
                });
                const vacuole = new THREE.Mesh(vacuoleGeometry, vacuoleMaterial);
                vacuole.name = 'vacuole';
                vacuole.position.set(0, centerY, 2);  // –ü–æ —Ü–µ–Ω—Ç—Ä—É –∫–ª—ñ—Ç–∏–Ω–∏
                // –ü—Ä–∏–ø–ª—é—Å–Ω—É—Ç–∞ —Ñ–æ—Ä–º–∞
                vacuole.scale.set(0.9, 1.4, 1.2);  // –ü—Ä–∏–ø–ª—é—Å–Ω—É—Ç–∞ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª—ñ
                scene.add(vacuole);
                cellElements['vacuole'] = vacuole;
                
                // –Ø–î–†–û - –∑–º—ñ—â—É—î–º–æ –≤–±—ñ–∫ –≤—ñ–¥ –≤–∞–∫—É–æ–ª—ñ
                const nucleusGeometry = new THREE.SphereGeometry(1.2, 32, 32);
                const nucleusMaterial = new THREE.MeshPhongMaterial({ 
                    color: 0xF44336,
                    emissive: 0x441111,
                    shininess: 30
                });
                const nucleus = new THREE.Mesh(nucleusGeometry, nucleusMaterial);
                nucleus.name = 'nucleus';
                nucleus.position.set(0, centerY, -2.5);  // –ó–º—ñ—â—É—î–º–æ –≤—ñ–¥ –≤–∞–∫—É–æ–ª—ñ
                scene.add(nucleus);
                cellElements['nucleus'] = nucleus;
                
                // –•–õ–û–†–û–ü–õ–ê–°–¢–ò - —Ä–æ–∑—Ç–∞—à–æ–≤—É—î–º–æ –Ω–∞–≤–∫–æ–ª–æ –≤–∞–∫—É–æ–ª—ñ, –∞–ª–µ –Ω–µ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –Ω–µ—ó
                const innerRadius = 2.5;  // –†–∞–¥—ñ—É—Å –¥–ª—è —Ö–ª–æ—Ä–æ–ø–ª–∞—Å—Ç—ñ–≤
                for (let i = 0; i < 10; i++) {
                    const angle = (i / 10) * Math.PI * 2;
                    const distance = innerRadius + (Math.random() * 2);  // –í—ñ–¥—Å—Ç–∞–Ω—å –≤—ñ–¥ —Ü–µ–Ω—Ç—Ä—É
                    const x = Math.cos(angle) * distance;
                    const z = Math.sin(angle) * distance;
                    const y = centerY + (Math.random() - 0.5) * 7;  // –†–æ–∑–∫–∏–¥ –ø–æ –≤–∏—Å–æ—Ç—ñ
                    
                    // –°—Ç–≤–æ—Ä—é—î–º–æ –µ–ª—ñ–ø—Å–æ—ó–¥ –¥–ª—è —Ö–ª–æ—Ä–æ–ø–ª–∞—Å—Ç–∞
                    const chloroplastGeometry = new THREE.SphereGeometry(0.5, 16, 16);
                    const chloroplastMaterial = new THREE.MeshPhongMaterial({ 
                        color: 0x4CAF50,
                        emissive: 0x1b5e20,
                        emissiveIntensity: 0.2
                    });
                    const chloroplast = new THREE.Mesh(chloroplastGeometry, chloroplastMaterial);
                    chloroplast.name = 'chloroplasts';
                    chloroplast.position.set(x, y, z);
                    // –†–æ–±–∏–º–æ –π–æ–≥–æ –µ–ª—ñ–ø—Å–æ—ó–¥–∞–ª—å–Ω–∏–º
                    chloroplast.scale.set(1.2, 0.8, 1.2);
                    // –í–∏–ø–∞–¥–∫–æ–≤–µ –æ–±–µ—Ä—Ç–∞–Ω–Ω—è
                    chloroplast.rotation.x = Math.random() * Math.PI;
                    chloroplast.rotation.y = Math.random() * Math.PI;
                    scene.add(chloroplast);
                    
                    if (i === 0) cellElements['chloroplasts'] = chloroplast;
                }
                
                // –ú–Ü–¢–û–•–û–ù–î–†–Ü–á - –≤–∏—Ç—è–≥–Ω—É—Ç—ñ —Å—Ñ–µ—Ä–∏
                for (let i = 0; i < 8; i++) {
                    const angle = (i / 8) * Math.PI * 2 + Math.PI / 6;
                    const distance = innerRadius + 0.5 + (Math.random() * 1.5);  // –¢—Ä–æ—Ö–∏ –¥–∞–ª—ñ –≤—ñ–¥ —Ü–µ–Ω—Ç—Ä—É
                    const x = Math.cos(angle) * distance;
                    const z = Math.sin(angle) * distance;
                    const y = centerY + (Math.random() - 0.5) * 5;
                    
                    // –°—Ç–≤–æ—Ä—é—î–º–æ –≤–∏—Ç—è–≥–Ω—É—Ç—É —Å—Ñ–µ—Ä—É –¥–ª—è –º—ñ—Ç–æ—Ö–æ–Ω–¥—Ä—ñ—ó
                    const mitochondriaGeometry = new THREE.SphereGeometry(0.4, 16, 16);
                    const mitochondriaMaterial = new THREE.MeshPhongMaterial({ 
                        color: 0x2196F3,
                        emissive: 0x0d47a1,
                        emissiveIntensity: 0.2
                    });
                    const mitochondria = new THREE.Mesh(mitochondriaGeometry, mitochondriaMaterial);
                    mitochondria.name = 'mitochondria';
                    mitochondria.position.set(x, y, z);
                    // –†–æ–±–∏–º–æ —ó—ó –≤–∏—Ç—è–≥–Ω—É—Ç–æ—é
                    mitochondria.scale.set(1.8, 0.6, 1.8);  // –í–∏—Ç—è–≥–Ω—É—Ç–∞ —Ñ–æ—Ä–º–∞
                    // –í–∏–ø–∞–¥–∫–æ–≤–µ –æ–±–µ—Ä—Ç–∞–Ω–Ω—è
                    mitochondria.rotation.x = Math.random() * Math.PI;
                    mitochondria.rotation.y = Math.random() * Math.PI;
                    scene.add(mitochondria);
                    
                    if (i === 0) cellElements['mitochondria'] = mitochondria;
                }
                
                // –†–ò–ë–û–°–û–ú–ò - –º–∞–ª–µ–Ω—å–∫—ñ –∫—Ä–∞–ø–∫–∏ –≤ —Ü–∏—Ç–æ–ø–ª–∞–∑–º—ñ
                for (let i = 0; i < 40; i++) {
                    // –í–∏–ø–∞–¥–∫–æ–≤—ñ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ü–∏—Ç–æ–ø–ª–∞–∑–º–∏ (–∞–ª–µ –Ω–µ –≤ –≤–∞–∫—É–æ–ª—ñ)
                    let x, y, z;
                    let attempts = 0;
                    do {
                        const angle = Math.random() * Math.PI * 2;
                        const distance = Math.random() * cellRadius * 0.6;
                        x = Math.cos(angle) * distance;
                        z = Math.sin(angle) * distance;
                        y = Math.random() * cellHeight;
                        attempts++;
                        // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ –Ω–µ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è —Ç–æ—á–∫–∞ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –≤–∞–∫—É–æ–ª—ñ
                        const distanceToCenter = Math.sqrt(x*x + z*z);
                    } while (attempts < 100);
                    
                    const ribosomeGeometry = new THREE.SphereGeometry(0.08, 8, 8);
                    const ribosomeMaterial = new THREE.MeshPhongMaterial({ 
                        color: 0xFFEB3B,
                        emissive: 0xff9800,
                        emissiveIntensity: 0.3
                    });
                    const ribosome = new THREE.Mesh(ribosomeGeometry, ribosomeMaterial);
                    ribosome.name = 'ribosomes';
                    ribosome.position.set(x, y, z);
                    scene.add(ribosome);
                    
                    if (i === 0) cellElements['ribosomes'] = ribosome;
                }
                
                // –ï–ù–î–û–ü–õ–ê–ó–ú–ê–¢–ò–ß–ù–ê –°–Ü–¢–ö–ê - –ø–æ—Ä—É—á –∑ —è–¥—Ä–æ–º
                const endoplasmicGeometry = new THREE.TorusKnotGeometry(1, 0.3, 64, 8, 2, 3);
                const endoplasmicMaterial = new THREE.MeshPhongMaterial({ 
                    color: 0xFF5722,
                    wireframe: true,
                    transparent: true,
                    opacity: 0.8
                });
                const endoplasmic = new THREE.Mesh(endoplasmicGeometry, endoplasmicMaterial);
                endoplasmic.name = 'endoplasmic';
                endoplasmic.position.set(0, centerY, -2.5);  // –ü–æ—Ä—É—á –∑ —è–¥—Ä–æ–º
                endoplasmic.scale.set(3, 3, 3);
                scene.add(endoplasmic);
                cellElements['endoplasmic'] = endoplasmic;
                
                // –ö–û–ú–ü–õ–ï–ö–° –ì–û–õ–¨–î–ñ–Ü - —Å–∏—Å—Ç–µ–º–∞ —Ü–∏–ª—ñ–Ω–¥—Ä–∏—á–Ω–∏—Ö —à–∞—Ä—ñ–≤ –∑ –≤–µ–∑–∏–∫—É–ª–∞–º–∏
                const golgi = createGolgiComplex();
                golgi.name = 'golgi';
                golgi.position.set(3, centerY, 2);
                golgi.scale.set(1.5, 1.5, 1.5);
                scene.add(golgi);
                cellElements['golgi'] = golgi;
                
                console.log('3D –º–æ–¥–µ–ª—å —É—Å–ø—ñ—à–Ω–æ —Å—Ç–≤–æ—Ä–µ–Ω–∞!');
                console.log('–†–æ–∑–º—ñ—Ä–∏ –∫–ª—ñ—Ç–∏–Ω–∏: —Ä–∞–¥—ñ—É—Å =', cellRadius, '–≤–∏—Å–æ—Ç–∞ =', cellHeight);
            } catch (error) {
                console.error('–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ 3D –º–æ–¥–µ–ª—ñ:', error);
                document.querySelector('.loading').innerHTML = '–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ 3D –º–æ–¥–µ–ª—ñ. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∫–æ–Ω—Å–æ–ª—å –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.';
                document.querySelector('.loading').style.display = 'block';
            }
        }
        
        // –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –æ–±—Ä–æ–±–∫–∏ –ø–æ–¥—ñ–π –º–∏—à—ñ
        function setupMouseEvents() {
            const raycaster = new THREE.Raycaster();
            const mouse = new THREE.Vector2();
            
            // –û–±—Ä–æ–±–∫–∞ –∫–ª—ñ–∫—É –º–∏—à—ñ –Ω–∞ –æ–±'—î–∫—Ç–∏
            renderer.domElement.addEventListener('click', (event) => {
                const rect = renderer.domElement.getBoundingClientRect();
                mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;
                mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;
                
                raycaster.setFromCamera(mouse, camera);
                const intersects = raycaster.intersectObjects(scene.children, true);
                
                if (intersects.length > 0) {
                    const clickedObject = intersects[0].object;
                    
                    // –í–∏–∑–Ω–∞—á–∞—î–º–æ ID –æ—Ä–≥–∞–Ω–µ–ª–∏
                    let organelleId = clickedObject.name;
                    
                    // –Ø–∫—â–æ —Ü–µ —á–∞—Å—Ç–∏–Ω–∞ –∫–æ–º–ø–ª–µ–∫—Å—É –ì–æ–ª—å–¥–∂—ñ
                    if (clickedObject.parent && clickedObject.parent.name === 'golgi') {
                        organelleId = 'golgi';
                    }
                    
                    // –í–∏–±–∏—Ä–∞—î–º–æ —Ü—é –æ—Ä–≥–∞–Ω–µ–ª—É
                    if (cellElementsInfo[organelleId] && state.organelleVisibility[organelleId]) {
                        selectOrganelle(organelleId);
                    }
                }
            });
        }
        
        // –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–µ—Ä—É–≤–∞–Ω–Ω—è
        function setupControls() {
            // –ü—Ä–æ–∑–æ—Ä—ñ—Å—Ç—å —Ü–∏—Ç–æ–ø–ª–∞–∑–º–∏
            document.getElementById('cytoplasmOpacity').addEventListener('input', function() {
                const value = parseFloat(this.value);
                document.getElementById('cytoplasmOpacityValue').textContent = value;
                if (cellElements['cytoplasm']) {
                    cellElements['cytoplasm'].material.opacity = value;
                }
            });
            
            // –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–∞–º–µ—Ä–∏
            document.getElementById('cameraSensitivity').addEventListener('input', function() {
                const value = parseFloat(this.value);
                document.getElementById('cameraSensitivityValue').textContent = value;
                settings.cameraSensitivity = value;
                controls.rotateSpeed = value;
            });
            
            // –ê–≤—Ç–æ–æ–±–µ—Ä—Ç–∞–Ω–Ω—è
            document.getElementById('autoRotate').addEventListener('click', function() {
                settings.autoRotate = !settings.autoRotate;
                const statusDot = this.querySelector('.organelle-status');
                statusDot.style.opacity = settings.autoRotate ? '1' : '0';
                
                if (settings.autoRotate) {
                    controls.autoRotate = true;
                    controls.autoRotateSpeed = 0.5;
                } else {
                    controls.autoRotate = false;
                }
            });
            
            // –°–∫–∏–¥–∞–Ω–Ω—è –≤–∏–¥—É
            document.getElementById('resetView').addEventListener('click', function() {
                controls.reset();
                camera.position.set(25, 20, 25);
                controls.update();
            });
            
            // –ü–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è –ø–∞–Ω–µ–ª–µ–π
            document.getElementById('toggle-controls').addEventListener('click', function() {
                document.getElementById('controlPanel').classList.toggle('collapsed');
            });
            
            document.getElementById('toggle-info').addEventListener('click', function() {
                document.getElementById('infoPanel').classList.toggle('collapsed');
            });
            
            document.getElementById('closeInfo').addEventListener('click', function() {
                document.getElementById('infoPanel').classList.add('collapsed');
            });
        }
        
        // –ü—Ä–∏—Ö–æ–≤—É–≤–∞–Ω–Ω—è –µ–ª–µ–º–µ–Ω—Ç–∞
        function hideElement(elementId) {
            if (cellElements[elementId]) {
                cellElements[elementId].visible = false;
                
                scene.traverse((object) => {
                    if (object.name && object.name.startsWith(elementId)) {
                        object.visible = false;
                    }
                });
                
                // –Ø–∫—â–æ –ø—Ä–∏—Ö–æ–≤–∞–ª–∏ –ø—ñ–¥—Å–≤—ñ—á–µ–Ω—É –æ—Ä–≥–∞–Ω–µ–ª—É, –∑–Ω—ñ–º–∞—î–º–æ –ø—ñ–¥—Å–≤—ñ—á—É–≤–∞–Ω–Ω—è
                if (state.highlightedElement === elementId) {
                    removeHighlight();
                }
            }
        }
        
        // –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –µ–ª–µ–º–µ–Ω—Ç–∞
        function showElement(elementId) {
            if (cellElements[elementId]) {
                cellElements[elementId].visible = true;
                
                scene.traverse((object) => {
                    if (object.name && object.name.startsWith(elementId)) {
                        object.visible = true;
                    }
                });
            }
        }
        
        // –ê–Ω—ñ–º–∞—Ü—ñ—è
        function animate() {
            requestAnimationFrame(animate);
            
            // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–Ω—Ç—Ä–æ–ª—ñ–≤
            controls.update();
            
            // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å—Ü–µ–Ω–∏
            renderer.render(scene, camera);
        }
        
        // –û–±—Ä–æ–±–∫–∞ –∑–º—ñ–Ω–∏ —Ä–æ–∑–º—ñ—Ä—É –≤—ñ–∫–Ω–∞
        function onWindowResize() {
            const container = document.getElementById('cell-scene');
            camera.aspect = container.clientWidth / container.clientHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(container.clientWidth, container.clientHeight);
        }
        
        // –ó–∞–ø—É—Å–∫ –¥–æ–¥–∞—Ç–∫–∞
        window.addEventListener('load', init);
        
        // –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∏–π –∑–∞–ø—É—Å–∫
        if (document.readyState === 'complete') {
            setTimeout(init, 100);
        }
    </script>
</body>
</html>
